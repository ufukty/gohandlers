<!-- Do not edit. Auto-generated by Kask  -->

<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Handling &amp; Customization Patterns in gohandlers - Gohandlers</title>

    
    <link rel="stylesheet" href="/propagate-f8ef0972-e352-4ecb-95fd-888369bde53a.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  </head>

  <body>

    <div class="site-wide-note">Machine generated documentation. <a href="https://github.com/ufukty/gohandlers/issues" target="_blank">Contribute</a> to improve quality together.</div>

    <div id="markdown-page-column-layout">

      <header>
        <nav id="sitemap">
          <details open>
            <summary>Site map</summary>
            <div class="summarized">
              

<ul>
  
  <a href="/index.html">gohandlers</a>
  
  
  <li>

<ul>
  
  <span>Articles</span>
  
  
  <li>

<ul>
  
  <span>Getting Started</span>
  
  
  
  <li>

<ul>
  
  <a href="/articles/getting-started/getting-started.html">Getting Started with gohandlers: Build HTTP APIs in Go‚ÄîEffortlessly!</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/articles/getting-started/overview.html">Overview: What Problem Does gohandlers Solve?</a>
  
  
  
</ul>

</li>
</ul>

</li>
  <li>

<ul>
  
  <span>Using Gohandlers</span>
  
  
  
  <li>

<ul>
  
  <a href="/articles/using-gohandlers/the-gohandler-way.html">The gohandlers Way of Writing HTTP Handlers in Go</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/articles/using-gohandlers/understanding-binding-structs-and-tags.html">Understanding Binding Structs and Tags in gohandlers</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/articles/using-gohandlers/understanding-validation-and-custom-types.html">Understanding Validation &amp; Custom Types in gohandlers</a>
  
  
  
</ul>

</li>
</ul>

</li>
  
</ul>

</li>
  <li>

<ul>
  
  <span>Reference</span>
  
  
  <li>

<ul>
  
  <span>Advanced</span>
  
  
  
  <li>

<ul>
  
  <a href="/reference/advanced/complex-api.html">Managing Complex APIs: Advanced Tag Usage in gohandlers</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/advanced/error-handling.html">Error Handling &amp; Customization Patterns in gohandlers</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/advanced/testing-clients.html">testing-clients</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/advanced/typed-clients.html">typed-clients</a>
  
  
  
</ul>

</li>
</ul>

</li>
  <li>

<ul>
  
  <span>Commands</span>
  
  
  
  <li>

<ul>
  
  <a href="/reference/commands/bindings.html">bindings</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/commands/client.html">client</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/commands/list.html">list</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/commands/mock.html">mock</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/commands/validate.html">validate</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/commands/yaml.html">yaml</a>
  
  
  
</ul>

</li>
</ul>

</li>
  <li>

<ul>
  
  <span>Core Concepts</span>
  
  
  
  <li>

<ul>
  
  <a href="/reference/core-concepts/metadata-driven.html">metadata-driven</a>
  
  
  
</ul>

</li>
  <li>

<ul>
  
  <a href="/reference/core-concepts/overview.html">overview</a>
  
  
  
</ul>

</li>
</ul>

</li>
  <li>

<ul>
  
  <span>Internals</span>
  
  
  
  <li>

<ul>
  
  <a href="/reference/internals/overview.html">overview</a>
  
  
  
</ul>

</li>
</ul>

</li>
  
</ul>

</li>
  
</ul>


            </div>
          </details>
        </nav>

        
        <nav id="toc">
          <details open>
            <summary>In this page</summary>
            <div class="summarized">
              <ul>
                
                <li>
                  <a href="#error-handling-customization-patterns-in-gohandlers" class="toc1">Error Handling &amp; Customization Patterns in gohandlers</a>
                  
                  <ul>
                    
                    <li>
                      <a href="#the-default-error-handling-flow" class="toc2">üöß The Default Error Handling Flow</a>
                      
                    </li>
                    <li>
                      <a href="#centralizing-error-handling" class="toc2">üîÑ Centralizing Error Handling</a>
                      
                    </li>
                    <li>
                      <a href="#custom-error-types" class="toc2">üß† Custom Error Types</a>
                      
                    </li>
                    <li>
                      <a href="#mapping-errors-to-status-codes" class="toc2">üõÇ Mapping Errors to Status Codes</a>
                      
                    </li>
                    <li>
                      <a href="#handling-validation-errors" class="toc2">üßæ Handling Validation Errors</a>
                      
                    </li>
                    <li>
                      <a href="#using-middleware-for-global-error-handling" class="toc2">üß∞ Using Middleware for Global Error Handling</a>
                      
                    </li>
                    <li>
                      <a href="#testing-errors-in-handlers" class="toc2">üß™ Testing Errors in Handlers</a>
                      
                    </li>
                    <li>
                      <a href="#best-practices" class="toc2">üßº Best Practices</a>
                      
                    </li>
                    <li>
                      <a href="#summary" class="toc2">‚úÖ Summary</a>
                      
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
          </details>
        </nav>
      </header>

      <script>
        function onChange(eval, callback) {
          let last;
          return () => {
            let next = eval()
            if (last != next) {
              last = next
              callback()
            }
          }
        }
        function detailsElemStateAdjuster() {
          let elems = document.querySelectorAll("nav>details")
          let summaries = document.querySelectorAll("nav>details>summary")
          return () => {
            elems.forEach(e => {
              e.open = window.innerWidth >= 700
            })
            summaries.forEach(e => {
              e.style.display = window.innerWidth >= 700 ? "none" : "block"
              e.onclick = window.innerWidth >= 700 ? (e) => { e.preventDefault() } : undefined
            })
          }
        }
        let adjuster = detailsElemStateAdjuster()
        adjuster()
        window.addEventListener("resize", onChange(() => { return window.innerWidth >= 700 }, adjuster, 100))
      </script>

      <main class="markdown">
        <h1 id="error-handling-customization-patterns-in-gohandlers">Error Handling &amp; Customization Patterns in gohandlers</h1>

<p>Error handling in HTTP APIs is one of the most nuanced parts of backend development. You want to be descriptive but secure, structured but flexible, and consistent across hundreds of endpoints.</p>

<p><strong>gohandlers</strong> provides you with just enough structure to handle errors cleanly, while giving you full control over how errors are generated, returned, logged, and encoded.</p>

<p>In this article, we‚Äôll explore the default error handling flow in gohandlers, and how you can customize it to fit your project‚Äôs needs‚Äîfrom basic validation to structured error types and application-specific conventions.</p>

<hr>

<h2 id="the-default-error-handling-flow">üöß The Default Error Handling Flow</h2>

<p>Out of the box, gohandlers separates your API logic into four clear steps:</p>

<ol>
<li><p><strong>Parse</strong> the incoming request:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></li>

<li><p><strong>Validate</strong> the parsed data:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">errs</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Validate</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="nx">errs</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusUnprocessableEntity</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">json</span><span class="p">.</span><span class="nf">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nf">Encode</span><span class="p">(</span><span class="nx">errs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></li>

<li><p><strong>Run your business logic</strong> (possibly returning custom errors)</p></li>

<li><p><strong>Write the response or handle application errors</strong>:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">resp</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">w</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;could not encode response&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></li>
</ol>

<p>This default structure is clean and minimal. But what if you want more structure? Let‚Äôs level up.</p>

<hr>

<h2 id="centralizing-error-handling">üîÑ Centralizing Error Handling</h2>

<p>Rather than duplicating error checks in every handler, you can introduce an error-handling layer:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">handleError</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">,</span> <span class="nx">status</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">log</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;error: %v&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">json</span><span class="p">.</span><span class="nf">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nf">Encode</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;error&#34;</span><span class="p">:</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>Use it like this:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">handleError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>This keeps your error output consistent and easily stylized (e.g. wrap messages, send error codes, log context).</p>

<hr>

<h2 id="custom-error-types">üß† Custom Error Types</h2>

<p>You can define structured error types that carry additional metadata:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">APIError</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Code</span>    <span class="kt">string</span> <span class="s">`json:&#34;code&#34;`</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Message</span> <span class="kt">string</span> <span class="s">`json:&#34;message&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="nx">e</span> <span class="o">*</span><span class="nx">APIError</span><span class="p">)</span> <span class="nf">Error</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;[%s] %s&#34;</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">Code</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">Message</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>In your app logic:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">APIError</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Code</span><span class="p">:</span>    <span class="s">&#34;duplicate_pet&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Message</span><span class="p">:</span> <span class="s">&#34;A pet with this name already exists&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>And in your centralized handler:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">apiErr</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">err</span><span class="p">.(</span><span class="o">*</span><span class="nx">APIError</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusConflict</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">json</span><span class="p">.</span><span class="nf">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nf">Encode</span><span class="p">(</span><span class="nx">apiErr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>Now you have semantic error codes <em>and</em> HTTP status codes.</p>

<hr>

<h2 id="mapping-errors-to-status-codes">üõÇ Mapping Errors to Status Codes</h2>

<p>Sometimes, it‚Äôs helpful to map known errors to appropriate HTTP responses. Here‚Äôs a simple mapping layer:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">mapErrorToStatus</span><span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">sql</span><span class="p">.</span><span class="nx">ErrNoRows</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusNotFound</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span> <span class="s">&#34;unauthorized&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusUnauthorized</span>
</span></span><span class="line"><span class="cl">  <span class="k">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>Or, with custom error wrapping:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="kd">var</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ErrNotFound</span> <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;not found&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ErrInvalid</span>  <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;invalid input&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">mapAppError</span><span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ErrNotFound</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusNotFound</span><span class="p">,</span> <span class="s">&#34;resource not found&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ErrInvalid</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span><span class="p">,</span> <span class="s">&#34;invalid data&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">,</span> <span class="s">&#34;internal server error&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<hr>

<h2 id="handling-validation-errors">üßæ Handling Validation Errors</h2>

<p>gohandlers generates a <code>Validate()</code> method that returns <code>map[string]error</code>. This is a perfect structure for field-level error reporting.</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;name is required&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;invalid email format&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>If you want to customize this further, define your own error wrapper:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">FieldErrors</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">FieldErrors</span><span class="p">)</span> <span class="nf">Error</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="s">&#34;validation failed&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>In your handler:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">errs</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Validate</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="nx">errs</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">fieldErrs</span> <span class="o">:=</span> <span class="nx">FieldErrors</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">errs</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fieldErrs</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="p">=</span> <span class="nx">v</span><span class="p">.</span><span class="nf">Error</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusUnprocessableEntity</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">json</span><span class="p">.</span><span class="nf">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nf">Encode</span><span class="p">(</span><span class="nx">fieldErrs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>Now you can keep field errors structured and style them however you like.</p>

<hr>

<h2 id="using-middleware-for-global-error-handling">üß∞ Using Middleware for Global Error Handling</h2>

<p>If you want to catch panics or abstract error formatting, you can wrap your handlers with middleware:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">RecoverAndReport</span><span class="p">(</span><span class="nx">next</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nf">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">defer</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="nx">v</span> <span class="o">:=</span> <span class="nb">recover</span><span class="p">();</span> <span class="nx">v</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">log</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;panic: %v&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;internal server error&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}()</span>
</span></span><span class="line"><span class="cl">    <span class="nx">next</span><span class="p">.</span><span class="nf">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>Then apply globally:</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="nx">mux</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">NewServeMux</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">h</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">handler</span><span class="p">.</span><span class="nf">ListHandlers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mux</span><span class="p">.</span><span class="nf">Handle</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">Path</span><span class="p">,</span> <span class="nf">RecoverAndReport</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">Ref</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<hr>

<h2 id="testing-errors-in-handlers">üß™ Testing Errors in Handlers</h2>

<p>Since gohandlers keeps your error flow centralized and clean, you can test each failure path independently.</p>
<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="nx">req</span> <span class="o">:=</span> <span class="nx">httptest</span><span class="p">.</span><span class="nf">NewRequest</span><span class="p">(</span><span class="s">&#34;POST&#34;</span><span class="p">,</span> <span class="s">&#34;/pets&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">rec</span> <span class="o">:=</span> <span class="nx">httptest</span><span class="p">.</span><span class="nf">NewRecorder</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">handler</span><span class="p">.</span><span class="nf">CreatePet</span><span class="p">(</span><span class="nx">rec</span><span class="p">,</span> <span class="nx">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">res</span> <span class="o">:=</span> <span class="nx">rec</span><span class="p">.</span><span class="nf">Result</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span> <span class="o">!=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">t</span><span class="p">.</span><span class="nf">Fatalf</span><span class="p">(</span><span class="s">&#34;expected 400, got %d&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre>
<p>You can even test custom error structures if you wrap your error responses consistently.</p>

<hr>

<h2 id="best-practices">üßº Best Practices</h2>

<ul>
<li>Use structured errors (with fields like <code>code</code>, <code>message</code>, <code>field</code>)</li>
<li>Map internal errors to HTTP-friendly messages</li>
<li>Centralize your error logging and response formatting</li>
<li>Always sanitize error messages shown to clients</li>
<li>Keep validation errors field-scoped and JSON-encoded</li>
<li>Don‚Äôt be afraid to panic and recover in dev/test environments</li>
</ul>

<hr>

<h2 id="summary">‚úÖ Summary</h2>

<p>Error handling in gohandlers gives you both structure and freedom:</p>

<ul>
<li>Structure through <code>Parse()</code> and <code>Validate()</code> conventions</li>
<li>Freedom through custom types, centralized handlers, and middleware</li>
</ul>

<p>Whether you&rsquo;re building a prototype or a production-grade API, gohandlers makes it easy to handle errors in a consistent, testable, and user-friendly way‚Äîwhile keeping your core logic clean.</p>

<p><strong>Say goodbye to duplicated if-else trees and hello to expressive, maintainable error flows.</strong></p>

<p>Happy handling! üí•üõ†Ô∏è‚úÖ</p>

      </main>

    </div>
  </body>

</html>
