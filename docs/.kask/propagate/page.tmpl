{{define "sitemap-item"}}
{{with .}}
<ul>
  {{if ne .Href ""}}
  <a href="{{.Href}}">{{.Title}}</a>
  {{else}}
  <span>{{.Title}}</span>
  {{end}}
  {{range .Children}}
  <li>{{template "sitemap-item" .}}</li>{{end}}
</ul>
{{end}}
{{end}}

{{define "toc-item"}}
{{if gt .Level 0}}<a href="#{{.ID}}" class="toc{{.Level}}">{{.Title}}</a>{{end}}
{{with .Children}}
<ul>
  {{range .}}
  <li>{{template "toc-item" .}}</li>{{end}}
</ul>{{end}}
{{end}}

{{define "markdown-page"}}
<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Node.Title}} — Gohandlers Docs</title>

    <link rel="icon" type="image/png" sizes="16x16" href="/.assets/favicon@1x.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/.assets/favicon@2x.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/.assets/favicon@3x.png">
    <link rel="icon" type="image/png" sizes="64x64" href="/.assets/favicon@4x.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/.assets/favicon@180w.png">

    <meta name="title" content="{{.Node.Title}} — Gohandlers Docs">
    <meta name="description" content="Discover the Gohandlers documentation, a comprehensive guide to building web applications with Go.">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://gohandlers.pages.dev">
    <meta property="og:title" content="{{.Node.Title}} — Gohandlers Docs">
    <meta property="og:description" content="Discover the Gohandlers documentation, a comprehensive guide to building web applications with Go.">
    <meta property="og:image" content="https://gohandlers.pages.dev/.assets/card-og.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://gohandlers.pages.dev">
    <meta name="twitter:title" content="{{.Node.Title}} — Gohandlers Docs">
    <meta name="twitter:description" content="Discover the Gohandlers documentation, a comprehensive guide to building web applications with Go.">
    <meta name="twitter:image" content="https://gohandlers.pages.dev/.assets/card-twitter.png">

    {{range .Stylesheets}}
    <link rel="stylesheet" href="{{.}}">{{end}}

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  </head>

  <body>

    <header>
      <button id="sitemap-button" onclick="toggleSitemap()">
        <svg class="header-icon" width="23px" height="18px" viewBox="0 0 23 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <rect x="0" y="0" width="23" height="2" rx="1"></rect>
          <rect x="0" y="8" width="23" height="2" rx="1"></rect>
          <rect x="0" y="16" width="23" height="2" rx="1"></rect>
        </svg>
      </button>

      <a href="/" id="logotype">Gohandlers</a>

      {{with .Markdown.Toc}}
      <button id="toc-button" onclick="toggleToc()">
        <svg class="header-icon" width="27px" height="20px" viewBox="0 0 27 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <rect x="0" y="0" width="4" height="4" rx="2"></rect>
          <rect x="0" y="8" width="4" height="4" rx="2"></rect>
          <rect x="0" y="16" width="4" height="4" rx="2"></rect>
          <rect x="9" y="1" width="18" height="2" rx="1"></rect>
          <rect x="9" y="9" width="18" height="2" rx="1"></rect>
          <rect x="9" y="17" width="18" height="2" rx="1"></rect>
        </svg>
      </button>
      {{end}}
    </header>

    <div id="navs">
      <nav id="sitemap">
        <div class="nav-header">Sitemap</div>
        {{template "sitemap-item" .Root}}
      </nav>
      {{with .Markdown.Toc}}
      <nav id="toc">
        <div class="nav-header">In this page</div>
        {{template "toc-item" .}}
      </nav>
      {{end}}
    </div>

    <script>
      var navs = document.getElementById("navs")
      var toc = document.getElementById("toc")
      var sitemap = document.getElementById("sitemap")
      /** @type {HTMLDivElement} */
      var onSpot = undefined
      /** @param {HTMLDivElement} elem */
      function toggleNavsFor(elem) {
        if (onSpot === elem) {
          onSpot.classList.remove("on-spot")
          navs.classList.remove("open");
          onSpot = undefined
        } else if (onSpot !== undefined) {
          navs.style.scrollBehavior = "smooth"
          navs.scrollLeft = elem.offsetLeft
          elem.classList.add("on-spot")
          onSpot.classList.remove("on-spot")
          onSpot = elem
        } else {
          navs.classList.add("open")
          navs.style.scrollBehavior = "none"
          navs.scrollLeft = elem.offsetLeft
          elem.classList.add("on-spot")
          onSpot = elem
        }
      }

      function toggleSitemap() {
        toggleNavsFor(sitemap)
      }
      function toggleToc() {
        toggleNavsFor(toc)
      }
    </script>

    <main class="markdown">
      {{.Markdown.Content}}
    </main>

  </body>

</html>
{{end}}